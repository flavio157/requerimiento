create view [dbo].[V_COMPROBANTE]
as
SELECT MAX(c.COD_COMPROBANTE)as COD_COMPROBANTE, dc.COD_PRODUCTO as COD_PRODUCTO,
FEC_ENTREGA,
SUM(dc.CANT_PRODUCTO) as CANTIDAD,SUM(dc.PREC_PRODUCTO) as PRECIO,
MAX(p.DES_PRODUCTO) as DES_PRODUCTO,MAX(p.UNI_MEDIDA) as UNI_MEDIDA
FROM T_COMPROBANTE as c
inner join T_DETACOMP as dc
on c.COD_COMPROBANTE = dc.COD_COMPROBANTE
inner join T_PRODUCTO as p 
on p.COD_PRODUCTO = dc.COD_PRODUCTO 
where p.COD_CATEGORIA = '00002' and c.ANULADO = 0
group by dc.COD_PRODUCTO,FEC_ENTREGA 
GO



create view [dbo].[V_COMP_VENTA]
as
SELECT MAX(v.CODIGO_CPVE) as CODIGO_CPVE,MAX(FECHA_CPVE) as FECHA_CPVE,i.COD_PRODUCTO,SUM(i.CANT_PRODUCTO) CANT_PRODUCTO,
SUM(i.PRE_PRODUCTO) as PRE_PRODUCTO
from T_COMP_VENTA as v
inner join T_COMP_VENTA_ITEM as i 
on i.CODIGO_CPVE = v.CODIGO_CPVE 
group by i.COD_PRODUCTO

GO



create view [dbo].[V_INSUMOS_USADOS]
as
SELECT f.COD_FORMULACION,f.COD_PRODUCTO as PRODUCTO,f.CAN_FORMULACION as CAN_FORMULACIO_CAB 
, fi.COD_PRODUCTO,p.DES_PRODUCTO,fi.CAN_FORMULACION as CAN_FORMULACION_ITEM,
fi.EST_FORMULACION from T_FORMULACION as f 
inner join T_FORMULACION_ITEM  as fi
on f.COD_FORMULACION = fi.COD_FORMULACION
inner join T_PRODUCTO as p
on p.COD_PRODUCTO = fi.COD_PRODUCTO 
where fi.EST_FORMULACION = '1' and p.COD_CATEGORIA = '00002' 
GO


create view [dbo].[V_ENVASES]
as
select e.COD_PRODUCTO , e.COD_FORMULACION,e.CANTIDAD,p.DES_PRODUCTO  FROM T_ENVASES_FORMULACION as e 
inner join T_PRODUCTO as p 
on p.COD_PRODUCTO = e.COD_PRODUCTO
inner join T_FORMULACION as f
on e.COD_FORMULACION = f.COD_FORMULACION
where e.ESTADO = '1'
GO
